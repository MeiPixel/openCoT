# 第2章:Linux系统管理
## 第2节:Linux文件权限和ACL
### Linux文件权限
在Linux系统中，每个文件和目录都有一个独特的权限设置，用于控制文件或目录的访问方式。文件权限由三个部分组成，分别是所有者权限、所有者组权限和其他用户权限。每个部分都可以设定可读（r）、可写（w）和可执行（x）的权限，也可以设置为没有权限（-）。

文件权限的基本原则是：读权限控制文件是否可以被读取，写权限控制文件是否可以被修改，执行权限控制文件是否可以被执行。

常用的文件权限标记如下：

- r：表示读权限。
- w：表示写权限。
- x：表示执行权限。
- -：表示没有权限。

### 关联性
文件权限的概念是Linux系统管理中非常重要的一部分，它与用户和组的管理、进程管理、服务管理等都有着紧密的联系。

### 示例和实践
为了演示文件权限的基本操作，我们可以通过命令行使用chmod命令设置文件的权限，例如：

- 设置foo文件可读可写权限：chmod u+rw foo
- 设置foo文件所有者组的读权限：chmod g+r foo
- 设置foo文件其他用户的执行权限：chmod o+x foo

### 逐步深入
除了基本的权限设置之外，Linux还提供了许多高级的权限控制技术，例如ACL（Access Control Lists）权限，它可以在个别文件和目录上分配更细粒度的访问控制。

### 注意事项和技巧
在设置文件权限时，需要确保只有必要的用户或组才能访问敏感文件。

### 检查和总结
- 文件权限的基本原则是什么？
- 常用的文件权限标记有哪些？
- 如何使用chmod命令设置文件的权限？

### 参考和资源
- Linux权限管理官方文档：https://www.kernel.org/doc/Documentation/filesystems/tmpfs.txt
## 第2节：Linux文件权限和ACL
### 2. Linux文件夹权限
Linux文件夹权限指文件夹的访问权限，由三种不同的权限组成：读、写、执行。对应的权限标记是r、w、x。权限标记也可以用数字来表示，r=4，w=2，x=1。因此，如果一个文件夹的权限是rwxr-xr--，就可以拆解成以下三个权限组：rwx，r-x 和 r--。其中，rwx 表示文件夹拥有者有读、写和执行权限， r-x 表示同组用户可以读取和执行，其他用户只能读取，r-- 表示其他用户只能读取。

在Linux中，文件夹权限同样可以使用chmod命令来进行修改。假设我们有一个名为demo的文件夹，要将它的权限设置为rwxr-xr--，可以用如下命令：

```
chmod 754 demo
```

其中，数字7代表rwx，5代表r-x，4代表r--。每个数字代表一个权限组，按顺序依次表示拥有者、同组用户、其他用户的权限。

在实际操作时，需要注意一些细节。比如，如果对一个文件夹进行了修改权限的操作，那么子文件夹和文件的权限会跟随父文件夹的权限而改变。因此，在进行权限修改时一定要小心，以免不小心改错权限导致系统出现故障。
## 第2节:Linux文件权限和ACL

### 特殊权限和文件属主变更

在Linux系统中，文件和目录除了基本的读、写、执行权限外，还有一些特殊权限，分别是SUID、SGID和SBIT权限。

- SUID权限（Set User ID）：表示一个可执行程序在运行时，会以该程序的属主身份来运行，而不是当前用户的身份。这个权限通常用于一些需要特殊权限才能执行的程序，比如passwd命令，只有root用户才能修改用户密码。一般情况下，SUID权限应该只在必要的情况下设置在必要的程序上，以免存在安全冲击点。SUID权限的设置用数字4表示。

- SGID权限（Set Group ID）：表示一个可执行程序在运行时，会以该程序的属组身份来运行，而不是当前用户的属组身份。因为一个文件只能属于一个用户，但可以属于多个用户组，所以SGID可以使多种用户组共享一个文件或目录。SGID权限的设置用数字2表示。

- SBIT权限（Sticky Bit）：一般情况下，Linux系统允许任何用户都可以在一个目录中创建、修改或删除文件。SBIT权限可以阻止普通用户删除别人的文件，只能由文件的属主和超级用户进行删除。SBIT权限的设置用数字1表示。

另外，在Linux系统中，每个文件和目录都有一个属主和属组。属主通常是创建该文件或目录的用户，属组是该用户所在的用户组。在一些情况下，需要更改一个文件或目录的属主或属组。

要更改文件属主，可以使用chown命令：
```
chown user file
```

要更改文件属主和属组，可以使用chown命令：
```
chown user:group file
```

例如，如果要将文件test.txt的属主和属组分别更改为user1和group1，可以使用以下命令：
```
chown user1:group1 test.txt
```

注意，只有root用户或原来的属主才能更改一个文件或目录的属主或属组。
# 第2节:Linux文件权限和ACL

## ACL（访问控制列表）

ACL是一种高级的文件权限控制机制，可以允许或禁止特定用户或组对某个特定文件或目录的访问。它允许更灵活的权限控制，例如允许多个用户或组访问某个文件或目录，而不仅仅是文件或目录的属主和所属组。

## ACL的基本属性

ACL有两种类型：默认ACL和访问ACL。

默认ACL是文件或目录在创建时就预设的ACL，它可以用于指定新创建的文件或目录的ACL属性。当给某个目录设置了默认ACL后，在该目录下创建的新文件或目录将自动继承该目录的ACL。

访问ACL是指对文件或目录的ACL进行单独设置，用于控制对该文件或目录的访问权限。

ACL包括两种权限：读写执行（rwx）和特殊权限（如设置suid、sgid等）。

## ACL的常用命令

- `setfacl`: 设置某个文件或目录的ACL。
- `getfacl`: 查看某个文件或目录的ACL。
- `chmod`: 修改文件或目录的权限，也可以用来修改特殊权限。
- `chgrp`: 修改文件或目录的所属组。
- `chown`: 修改文件或目录的属主。

总的来说，ACL是一个非常有用并且灵活的文件权限控制机制，它可以帮助管理员实现更加细粒度的权限控制，从而更好地保护系统安全和文件的机密性。
## 第2章:Linux系统管理
### 第2节:Linux文件权限和ACL
#### ACL的配置和使用

ACL（Access Control Lists）是一种更加细粒度的访问控制方式，与传统的基于文件权限的控制方式相比更加灵活。在Linux系统中，ACL使用setfacl和getfacl命令进行配置和查询。

##### 定义和解释
ACL是Access Control Lists的缩写，是一种在文件系统级别进行访问控制的技术，允许用户在文件或目录级别上控制访问权限。

##### 关联性
与Linux文件权限相比，ACL提供了更加细粒度的访问控制方式，可以精确控制哪些用户或组可以访问某个文件或目录。

##### 示例和实践
要使用ACL对文件或目录进行访问控制，首先需要确认文件系统是否支持ACL，并通过mount命令检查是否在挂载选项中设置了acl选项。然后，可以通过setfacl命令为指定用户或组授权，并通过getfacl命令查询当前文件的ACL设置。

例如，要为目录/home/user1/testdir授权给用户user2读取和写入权限，可以使用以下命令：

```bash
setfacl -m u:user2:rw /home/user1/testdir
```

然后可以使用getfacl命令查询当前目录的ACL设置：

```bash
getfacl /home/user1/testdir
```

##### 逐步深入
ACL技术是相对基于文件权限的控制方式的一种更加高级的访问控制技术，需要理解文件系统的底层机制和内部实现原理。在掌握基本概念后，需要逐步深入ACL的高级功能和应用。

##### 注意事项和技巧
在使用setfacl命令设置ACL时，需要注意仅对新创建的文件和目录生效，不影响已有的文件和目录。如果需要修改已有文件和目录的ACL设置，可以使用-r参数进行递归处理。

##### 检查和总结
- 如何查看文件系统是否支持ACL?
- 使用getfacl命令查询ACL设置的命令格式是什么？
- 如何对新创建的文件或目录设置ACL？
- 如何修改已有文件和目录的ACL设置？

##### 参考和资源
- man手册：setfacl，getfacl
## 第2节:Linux文件权限和ACL

### 其他相关权限设置和注意事项

在设置文件或目录的权限时，需要注意安全性。一般情况下，只有拥有者和管理员具有修改权限，其他用户只能读取或者执行该文件。

可以使用`chmod`命令来设置文件或目录的权限，使用`ls -l`命令来查看权限信息，例如：

```
chmod 600 file.txt  # 设置文件的拥有者具有读写权限，其他用户没有任何权限
ls -l file.txt     # 查看文件的权限信息
```

此外，为避免误操作，建议在修改文件或目录的权限时，先备份数据，然后再进行操作。如果不小心误操作，可以使用`chmod`命令来修复权限，例如：

```
chmod 755 /path/to/dir      # 将目录权限修复为默认的 rwxr-xr-x
chmod 644 /path/to/file     # 将文件权限修复为默认的 rw-r--r--
```

综上所述，正确设置文件或目录的权限是Linux系统管理的重要内容之一，需要仔细处理，以确保数据的安全性和可靠性。
